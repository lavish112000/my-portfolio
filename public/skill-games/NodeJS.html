<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Node.js Tutorial</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700&family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #854d0e; /* Amber 800 */
            --secondary-color: #d97706; /* Amber 600 */
            --text-color-dark: #422f28; /* Dark brown */
            --text-color-light: #6b4639;
            --border-color: rgba(133, 77, 14, 0.2);
            --panel-bg: rgba(255, 255, 255, 0.5); 
        }

        @keyframes pop-in { 0% { transform: scale(0.9); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
        @keyframes pulse-glow { 0%, 100% { box-shadow: 0 0 15px var(--primary-color); } 50% { box-shadow: 0 0 25px var(--primary-color); } }
        @keyframes slide-in-up { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        html {
            scroll-behavior: smooth;
        }

        body {
            margin: 0;
            font-family: 'Inter', sans-serif;
            color: var(--text-color-dark);
            line-height: 1.7;
            background: linear-gradient(to bottom, #f4f6ec, #e2d8c3, #efc87d);
            background-attachment: fixed;
        }
        
        .tutorial-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 50px 20px;
            border-bottom: 1px solid var(--border-color);
        }

        header h1 {
            font-family: 'Inter', sans-serif;
            font-weight: 700;
            font-size: clamp(2.5em, 8vw, 4.5em);
            color: var(--text-color-dark);
            margin: 0;
        }
        
        header h1 .highlight {
             color: var(--primary-color);
             text-shadow: 0 0 10px var(--primary-color);
        }

        header p {
            font-size: clamp(1em, 3vw, 1.2em);
            max-width: 700px;
            margin: 15px auto 0;
            color: var(--text-color-light);
        }
        
        .tutorial-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            align-items: center;
            padding: 60px 20px;
            border-bottom: 1px solid var(--border-color);
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        
        .tutorial-section.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .explanation h2 {
            font-family: 'Inter', sans-serif;
            font-weight: 700;
            color: var(--text-color-dark);
            font-size: 2.2em;
            margin-top: 0;
        }

        .code-block {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            padding: 15px;
            font-family: 'Roboto Mono', monospace;
            font-size: 0.85em;
            white-space: pre-wrap;
            border: 1px solid var(--border-color);
        }
        
        .visualization {
            background: var(--panel-bg);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            height: 450px;
            position: relative;
            padding: 20px;
            box-sizing: border-box;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            -webkit-backdrop-filter: blur(10px);
            backdrop-filter: blur(10px);
        }
        
        .viz-controls {
            position: absolute;
            top: 15px;
            left: 15px;
            display: flex;
            gap: 10px;
            align-items: center;
            z-index: 10;
        }
        
        .viz-button {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Inter';
            font-weight: 500;
            transition: background-color 0.2s, transform 0.2s;
        }
        .viz-button:hover { background-color: #d97706; transform: translateY(-2px); }

        /* Specific Viz Styles */
        #event-loop-viz {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-template-rows: 1fr 1fr;
            gap: 15px;
            width: 100%; height: 100%;
            font-size: 0.9em;
        }
        .loop-area { border: 1px solid var(--border-color); border-radius: 5px; padding: 10px; text-align: center; }
        .loop-area h4 { margin: 0 0 10px 0; font-weight: bold; }
        #call-stack { grid-row: 1 / 3; }
        .task-item {
            background: var(--secondary-color);
            color: white;
            padding: 8px;
            border-radius: 4px;
            margin-bottom: 5px;
            animation: slide-in-up 0.3s;
            transition: all 0.5s;
        }

        #modules-viz { flex-direction: column; gap: 15px; }
        .file-box {
            border: 1px solid var(--border-color);
            border-radius: 5px;
            padding: 15px;
            width: 80%;
            background: rgba(255, 255, 255, 0.2);
        }

        #fs-viz { flex-direction: column; gap: 15px; }
        #fs-editor { width: 80%; height: 150px; background: #fff; color: #333; border-radius: 5px; padding: 10px; }
        #fs-file-content { width: 80%; min-height: 50px; background: #eee; color: #333; border-radius: 5px; padding: 10px; }
        
        #http-viz { text-align: center; }
        .http-entity { transition: transform 0.5s ease-in-out; }
        .http-arrow { opacity: 0; transition: opacity 0.5s; font-size: 2em; color: var(--primary-color); }
        .http-arrow.visible { opacity: 1; }
        
        #npm-viz { flex-direction: column; gap: 10px; }
        #npm-packages { display: flex; gap: 10px; }
        .npm-package { padding: 5px 10px; border-radius: 5px; background: var(--secondary-color); color: white; opacity: 0; transition: opacity 0.5s; }
        .npm-package.visible { opacity: 1; }

        footer {
            text-align: center;
            padding: 50px 20px;
            margin-top: 20px;
        }
        .further-exploration {
            text-align: left;
            background: var(--panel-bg);
            border-radius: 10px;
            padding: 30px;
            margin-top: 20px;
            border: 1px solid var(--border-color);
            color: var(--text-color);
        }
        .further-exploration h2 { color: var(--primary-color); }
        .exploration-column h3 { color: var(--secondary-color); }
        .exploration-column a { color: var(--text-color); }
        .exploration-column a:hover { color: var(--primary-color); }
        .exploration-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 30px; margin-top: 20px; }
        .exploration-column ul { list-style: none; padding: 0; }
        .exploration-column li { margin-bottom: 10px; background: url('data:image/svg+xml;charset=UTF-8,%3csvg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24" fill="none" stroke="%23E4B55D" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"%3e%3ccheck-circle%3e%3cpath d="M22 11.08V12a10 10 0 1 1-5.93-9.14"%3e%3c/path%3e%3cpolyline points="22 4 12 14.01 9 11.01"%3e%3c/polyline%3e%3c/check-circle%3e%3c/svg%3e') no-repeat left center; padding-left: 30px; }

        /* Responsive Design */
        @media (max-width: 768px) {
            .tutorial-section {
                grid-template-columns: 1fr;
            }
            .visualization {
                height: auto;
                min-height: 400px;
            }
        }

        /* Back button styles */
        .back-button {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 1000;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .back-button:hover {
            background: white;
            transform: scale(1.1);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }

        /* Inline style replacement */
        .further-exploration > div:first-child {
            grid-column: 1 / -1;
        }
    </style>
</head>
<body>
    <button class="back-button" onclick="window.close()" title="Back to Portfolio">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#339933" stroke-width="2">
            <path d="M19 12H5M12 19l-7-7 7-7"/>
        </svg>
    </button>

    <div class="tutorial-container">
        <header>
            <h1>The <span class="highlight">Node.js</span> Event Horizon</h1>
            <p>An interactive guide to the powerful JavaScript runtime that lets you build fast, scalable server-side applications.</p>
        </header>

        <!-- SECTION 1: Event Loop -->
        <section class="tutorial-section">
            <div class="explanation">
                <h2>1. The Event Loop</h2>
                <p>Node.js is single-threaded, but it achieves high performance using an <strong>Event Loop</strong>. When an asynchronous operation (like reading a file) is called, it's offloaded. The main thread is never blocked, and a callback is placed in a queue to be executed once the operation completes.</p>
            </div>
            <div id="event-loop-viz" class="visualization">
                <div class="viz-controls">
                    <button id="add-sync-btn" class="viz-button">Run Sync Task</button>
                    <button id="add-async-btn" class="viz-button">Run Async Task</button>
                </div>
                <div id="call-stack" class="loop-area"><h4>Call Stack</h4></div>
                <div id="node-apis" class="loop-area"><h4>Node APIs</h4></div>
                <div id="callback-queue" class="loop-area"><h4>Callback Queue</h4></div>
            </div>
        </section>

        <!-- SECTION 2: Modules -->
        <section class="tutorial-section">
            <div class="explanation">
                <h2>2. Modules</h2>
                <p>Node.js uses a module system to organize code. You can encapsulate related functions in one file and export them for use in other files using <code>module.exports</code>. You then import them with <code>require()</code>.</p>
                <div class="code-block">// app.js<br>const math = require('./math.js');<br>console.log(math.add(2, 3)); // 5</div>
            </div>
            <div id="modules-viz" class="visualization">
                <div class="file-box">
                    <strong>math.js</strong>
                    <div class="code-block">const add = (a, b) => a + b;<br>module.exports = { add };</div>
                </div>
                <div class="text-2xl font-bold">↓</div>
                <div class="file-box">
                    <strong>app.js</strong>
                    <div class="code-block">const math = require('./math.js');</div>
                </div>
            </div>
        </section>

        <!-- SECTION 3: File System -->
        <section class="tutorial-section">
            <div class="explanation">
                <h2>3. File System (fs)</h2>
                <p>One of Node's core modules is <code>fs</code>, which allows you to interact with the file system. You can read, write, and update files asynchronously, making it perfect for server-side tasks.</p>
            </div>
            <div id="fs-viz" class="visualization">
                 <label for="fs-editor">File Content:</label>
                 <textarea id="fs-editor">Hello from Node.js!</textarea>
                 <button id="fs-write-btn" class="viz-button">Write to file.txt</button>
                 <div id="fs-file-content"></div>
            </div>
        </section>

        <!-- SECTION 4: HTTP Server -->
        <section class="tutorial-section">
            <div class="explanation">
                <h2>4. Creating a Web Server</h2>
                <p>Node.js excels at creating fast, simple web servers using the built-in <code>http</code> module. It can handle a large number of concurrent connections efficiently thanks to its non-blocking I/O model.</p>
            </div>
            <div id="http-viz" class="visualization">
                <div id="http-client" class="http-entity">
                    <svg class="w-24 h-24" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9 17.25v1.007a3 3 0 01-.879 2.122L7.5 21h9l-1.621-.621a3 3 0 01-.879-2.122v-1.007M15 9.75a3 3 0 11-6 0 3 3 0 016 0z" /></svg>
                    <p>Client</p>
                </div>
                <div class="http-arrow">→ Request →</div>
                <div id="http-server" class="http-entity">
                     <svg class="w-24 h-24" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M21.75 17.25v-.228a4.5 4.5 0 00-.12-1.03l-2.268-9.64a3.375 3.375 0 00-3.285-2.602H7.923a3.375 3.375 0 00-3.285 2.602l-2.268 9.64a4.5 4.5 0 00-.12 1.03v.228m15.457 0a4.5 4.5 0 01-1.343 3.162l-2.267 2.267a4.5 4.5 0 01-6.364 0l-2.267-2.267a4.5 4.5 0 01-1.343-3.162m15.457 0l-15.457 0" /></svg>
                    <p>Node.js Server</p>
                </div>
                <div class="viz-controls">
                    <button id="http-request-btn" class="viz-button">Send Request</button>
                </div>
            </div>
        </section>
        
        <!-- SECTION 5: NPM -->
        <section class="tutorial-section">
             <div class="explanation">
                <h2>5. NPM: Node Package Manager</h2>
                <p><strong>NPM</strong> is the world's largest software registry. It's a command-line tool that allows you to install, share, and manage third-party packages (reusable code libraries). Frameworks like Express.js are installed via NPM.</p>
            </div>
            <div id="npm-viz" class="visualization">
                <div class="file-box text-sm">
                    <strong>package.json</strong><br>
                    { "dependencies": { "express": "4.18.2" } }
                </div>
                <button id="npm-install-btn" class="viz-button my-4">Run `npm install`</button>
                <div class="file-box w-full flex-grow">
                    <strong>/node_modules</strong>
                    <div id="npm-packages"></div>
                </div>
            </div>
        </section>
        
        <footer class="tutorial-section further-exploration">
            <div>
                <h2>Continue Your Journey</h2>
                <div class="exploration-grid">
                    <div class="exploration-column">
                        <h3>Official & Core Resources</h3>
                        <ul>
                            <li><a href="https://nodejs.org/en/docs/" target="_blank" rel="noopener">Official Node.js Docs</a></li>
                            <li><a href="https://www.npmjs.com/" target="_blank" rel="noopener">NPM Registry</a></li>
                            <li><a href="https://expressjs.com/" target="_blank" rel="noopener">Express.js Framework</a></li>
                             <li><a href="https://github.com/nodejs" target="_blank" rel="noopener">Node.js on GitHub</a></li>
                        </ul>
                    </div>
                    <div class="exploration-column">
                        <h3>Learning Platforms</h3>
                        <ul>
                            <li><a href="https://www.w3schools.com/nodejs/" target="_blank" rel="noopener">W3Schools Node.js Tutorial</a></li>
                            <li><a href="https://www.freecodecamp.org/news/tag/node/" target="_blank" rel="noopener">freeCodeCamp Articles</a></li>
                            <li><a href="https://nodeschool.io/" target="_blank" rel="noopener">NodeSchool (Workshops)</a></li>
                            <li><a href="https://developer.mozilla.org/en-US/docs/Learn/Server-side/Express_Nodejs" target="_blank" rel="noopener">MDN Express/Node Intro</a></li>
                        </ul>
                    </div>
                    <div class="exploration-column">
                        <h3>Practice Project Ideas</h3>
                        <ul>
                            <li>A simple REST API for a blog</li>
                            <li>A real-time chat application</li>
                            <li>A command-line tool for file operations</li>
                            <li>A web scraper to collect data</li>
                            <li>A URL shortener service</li>
                        </ul>
                    </div>
                </div>
            </div>
        </footer>

    </div>

    <script>
        // --- Animate on Scroll ---
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                }
            });
        }, { threshold: 0.2 });

        document.querySelectorAll('.tutorial-section').forEach(section => {
            observer.observe(section);
        });
        
        const sleep = (ms) => new Promise(res => setTimeout(res, ms));

        // --- Viz 1: Event Loop ---
        const callStack = document.getElementById('call-stack');
        const nodeApis = document.getElementById('node-apis');
        const callbackQueue = document.getElementById('callback-queue');
        
        async function runSyncTask() {
            const task = document.createElement('div');
            task.className = 'task-item';
            task.textContent = 'Sync Task';
            callStack.appendChild(task);
            await sleep(1000);
            task.remove();
        }
        
        async function runAsyncTask() {
            const task1 = document.createElement('div');
            task1.className = 'task-item';
            task1.textContent = 'readFile() call';
            callStack.appendChild(task1);
            await sleep(500);

            const task2 = document.createElement('div');
            task2.className = 'task-item bg-amber-600';
            task2.textContent = 'Reading file...';
            nodeApis.appendChild(task2);
            task1.remove();

            await sleep(2000);
            const task3 = document.createElement('div');
            task3.className = 'task-item bg-green-600';
            task3.textContent = 'Callback';
            callbackQueue.appendChild(task3);
            task2.remove();

            await sleep(500);
            callStack.appendChild(task3);
            
            await sleep(1000);
            task3.remove();
        }
        
        document.getElementById('add-sync-btn').onclick = runSyncTask;
        document.getElementById('add-async-btn').onclick = runAsyncTask;
        
        // --- Viz 3: File System ---
        const fsEditor = document.getElementById('fs-editor');
        const fsFileContent = document.getElementById('fs-file-content');
        document.getElementById('fs-write-btn').onclick = () => {
            fsFileContent.textContent = `Content of file.txt:\n\n${fsEditor.value}`;
        };

        // --- Viz 4: HTTP Server ---
        const httpClient = document.getElementById('http-client');
        const httpServer = document.getElementById('http-server');
        const httpArrow = document.querySelector('.http-arrow');
        document.getElementById('http-request-btn').onclick = async () => {
            httpArrow.classList.add('visible');
            httpClient.style.transform = 'scale(1.1)';
            await sleep(500);
            httpServer.style.transform = 'scale(1.1)';
            await sleep(1000);
            httpClient.style.transform = 'scale(1)';
            httpServer.style.transform = 'scale(1)';
            httpArrow.classList.remove('visible');
        };
        
        // --- Viz 5: NPM ---
        const npmPackages = document.getElementById('npm-packages');
        document.getElementById('npm-install-btn').onclick = () => {
            npmPackages.innerHTML = '';
            const pkg = document.createElement('div');
            pkg.className = 'npm-package';
            pkg.textContent = 'express';
            npmPackages.appendChild(pkg);
            setTimeout(() => pkg.classList.add('visible'), 100);
        };

        // ScrollFloat animation for heading
        const heading = document.querySelector('header h1');
        if (heading) {
            const text = heading.textContent;
            const chars = text.split('');
            
            heading.innerHTML = chars.map(char => 
                `<span class="inline-block" style="will-change: opacity, transform;">${char === ' ' ? '\u00A0' : char}</span>`
            ).join('');
            
            const charElements = heading.querySelectorAll('.inline-block');
            
            gsap.fromTo(
                charElements,
                {
                    willChange: 'opacity, transform',
                    opacity: 0,
                    yPercent: 120,
                    scaleY: 2.3,
                    scaleX: 0.7,
                    transformOrigin: '50% 0%'
                },
                {
                    duration: 1,
                    ease: 'back.inOut(2)',
                    opacity: 1,
                    yPercent: 0,
                    scaleY: 1,
                    scaleX: 1,
                    stagger: 0.03,
                    scrollTrigger: {
                        trigger: heading,
                        start: 'center bottom+=50%',
                        end: 'bottom bottom-=40%',
                        scrub: true
                    }
                }
            );
        }
        
    </script>
</body>
</html>

